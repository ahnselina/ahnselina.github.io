---
title: LizardFS安装指南
date: 2019-01-17 22:19:35
categories: 
- 分布式存储
tags: [LizardFS, lizardfs, 安装]
---

![](http://wx3.sinaimg.cn/mw690/71c65545gy1fz9y83nq22j20pr0bqabx.jpg)
<!-- more -->
本文主要介绍下载安装包安装的方式，其他安装方式请参考官方文档：
[Installing LizardFS](https://docs.lizardfs.com/adminguide/installation.html)。  
并且本文介绍的安装仅限于master-shadowmaster模式，笔者理解为主备模式，当然备可以有多个。
HA集群模式的安装方法改天详细介绍下，这个里面还有蛮多坑。
关于lizardfs的特性可参考[LizardFS介绍](http://www.a-programmer.top/2019/01/15/LizardFS%E4%BB%8B%E7%BB%8D/)一文。

PS:本文主要记录安装使用的命令，具体切换目录这些本文就省略了

## 安装规划准备环境
主要准备环境，规划好各节点用于什么角色  
比如笔者有三个节点，规划反映到/etc/hosts里面：  
192.168.0.1  mfsmaster chunkserver1 metalogger
192.168.0.2  shadowmaster chunkserver2
192.168.0.3  chunkserver3 cgiserver

***注:每个节点的/etc/hosts都要修改哦***

## master-shadowmaster模式安装步骤
参考上一节将各节点角色配置到各个节点的/etc/hosts文件中
到https://lizardfs.com/download/#toggle-id-2
下载对应系统的安装包
![](http://wx3.sinaimg.cn/mw690/71c65545gy1fz9y81dg0xj20i70eewei.jpg)
笔者是CentOS 7.5，所以下了对应的包，解开里面包含文件如下：
![](http://wx4.sinaimg.cn/mw690/71c65545gy1fz9y81s7u8j20gn0aq0t3.jpg)

### mfsmaster节点安装

主要用如下命令：
```shell
rpm –ivh lizardfs-master-3.13.0-0el7.x86_64.rpm
rpm –ivh lizardfs-adm-3.13.0-0el7.x86_64.rpm

cp /var/lib/mfs/metadata.mfs.empty  /var/lib/mfs/metadata.mfs
cp /etc/mfs/mfsexports.cfg.dist  /etc/mfs/mfsexports.cfg

vi /etc/mfs/mfsmaster.cfg
PERSONALITY = master

service lizardfs-master start
```
### shadowmaster节点安装

```shell
rpm –ivh lizardfs-master-3.13.0-0el7.x86_64.rpm
rpm –ivh lizardfs-adm-3.13.0-0el7.x86_64.rpm

cp /var/lib/mfs/metadata.mfs.empty  /var/lib/mfs/metadata.mfs
cp /etc/mfs/mfsexports.cfg.dist  /etc/mfs/mfsexports.cfg

vi /etc/mfs/mfsmaster.cfg
PERSONALITY = shadow

service lizardfs-master start
```
 shadowmaster节点与master节点的区别其实就是配置文件/etc/mfs/mfsmaster.cfg里面的PERSONALITY值不同。
 
### chunkserver与metalogger节点
```shell
rpm –ivh lizardfs-chunkserver-3.13.0-0el7.x86_64.rpm
rpm –ivh lizardfs-metalogger-3.13.0-0el7.x86_64.rpm
vi /etc/default/lizardfs-chunkserver
LIZARDFSCHUNKSERVER_ENABLE=true
vi /etc/default/lizardfs-metalogger
LIZARDFSMETALOGGER_ENABLE=true
```

***注意：下面的盘符需要根据实际环境上的做相应的修改：***  
```shell
mkfs.ext3 /dev/sdd
mkdir /mnt/chunk1
mount /dev/sdd /mnt/chunk1
vi /etc/mfs/mfshdd.cfg
/mnt/chunk1

chown -R mfs:mfs /mnt/chunk1
```

注意：
* 如果需要多个盘，多次重复上面类似操作，可以mount到/mnt/chunk2，/mnt/chunk3…
* chown -R mfs:mfs **,这个操作忘了会报权限错误

启动metalogger
```
service lizardfs-metalogger start
```

启动chunkserver
```
mfschunkserver start
```

### cgiserver 节点
```shell
rpm –ivh lizardfs-cgi-3.13.0-0el7.x86_64.rpm
rpm –ivh lizardfs-cgiserv-3.13.0-0el7.x86_64.rpm
#启动cgiserver
mfscgiserv start
```
启动cgiserver后，便可以通过网页http://192.168.0.3:9425/mfs.cgi 查看目前集群的状态信息，包括master信息，chunkservers信息等等。

### client节点
```shell
yum install fuse
yum install fuse-libs
yum install bash-completion
rpm –ivh lizardfs-client-3.13.0-0el7.x86_64.rpm

mfsmount /mnt/lizardfs –H 192.168.0.1
```
执行mfsmount之后，就可以像操作本地文件夹一样操作/mnt/lizardfs，非常方便，还可以设置副本策略等等。  


## 参考资料
[LizardFS官网](https://lizardfs.com/)  
[Installing LizardFS](https://docs.lizardfs.com/adminguide/installation.html)
